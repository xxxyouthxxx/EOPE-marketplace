(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2ddc3668"],{9521:function(e,t,a){"use strict";a("d34c")},cd98:function(e,t,a){"use strict";a.r(t);var c=a("7a23");const o=e=>(Object(c["pushScopeId"])("data-v-1fd4f97f"),e=e(),Object(c["popScopeId"])(),e),n={class:"page-wrap"},s={class:"header-section has-header-main bg-pattern-3"},r={class:"create-section section-space-b pt-4 pt-md-5 mt-md-4"},l={class:"d-flex SaleCreateSection"},d={class:"container d-flex justify-content-end"},i={class:"row justify-content-center align-self-start"},m=Object(c["createStaticVNode"])('<div class="col-lg-8" data-v-1fd4f97f><div class="section-head-sm" data-v-1fd4f97f><a href="/details/" class="btn-link fw-semibold" data-v-1fd4f97f><em class="ni ni-arrow-left" data-v-1fd4f97f></em> Back</a><h1 class="mt-2" data-v-1fd4f97f>List item for sale</h1></div></div>',1),b={class:"col-lg-8"},f={action:"#",class:"form-create mb-5 mb-lg-0"},h={class:"form-item mb-4"},p=o(()=>Object(c["createElementVNode"])("h5",{class:"mb-3"},"Price",-1)),u={class:"mb-4 d-flex"},j=o(()=>Object(c["createElementVNode"])("div",{class:"col-4 pe-1"},[Object(c["createElementVNode"])("select",{class:"form-select",disabled:"","aria-label":"Default select example"},[Object(c["createElementVNode"])("option",{selected:""},"₿ SSF"),Object(c["createElementVNode"])("option",{value:"1"},"ETH")])],-1)),O={class:"col"},N={class:"form-item mb-4"},g={class:"mb-4"},k=o(()=>Object(c["createElementVNode"])("label",{class:"mb-2 form-label"},"Duration",-1)),v={class:"container"},V={class:"card card-full",style:{"max-width":"500px",height:"auto"}},D={class:"card-image"},E=["src"],w={class:"card-body p-4"},T={class:"card-title text-truncate mb-0"},y={class:"card-author my-3 d-flex align-items-center"},S=o(()=>Object(c["createElementVNode"])("span",{class:"me-1 card-author-by"},"By",-1)),I={class:"custom-tooltip-wrap"},C=["href"],x={class:"card-price-wrap d-flex align-items-center justify-content-sm-between mb-3"},A=o(()=>Object(c["createElementVNode"])("div",{class:"me-5 me-sm-2"},[Object(c["createElementVNode"])("span",{class:"card-price-title"},"Type"),Object(c["createElementVNode"])("h4",{class:"card-price-number"},"NFT")],-1)),P={class:"text-sm-end"},F=o(()=>Object(c["createElementVNode"])("span",{class:"card-price-title"},"Price",-1)),M={class:"card-price-number"},B={key:0,class:"modal fade",id:"saleCreateNftModal",tabindex:"-1","aria-hidden":"true"},K={class:"modal-dialog modal-dialog-centered"},q={class:"modal-content"},U=o(()=>Object(c["createElementVNode"])("div",{class:"modal-header"},[Object(c["createElementVNode"])("h4",{class:"modal-title"},"Confirm Your list"),Object(c["createElementVNode"])("button",{type:"button",class:"btn-close icon-btn","data-bs-dismiss":"modal","aria-label":"Close"},[Object(c["createElementVNode"])("em",{class:"ni ni-cross"})])],-1)),$={class:"modal-body"},H=o(()=>Object(c["createElementVNode"])("p",{class:"mb-3"},[Object(c["createTextVNode"])("Before list item for sale, Please "),Object(c["createElementVNode"])("strong",null,"input your Private Key"),Object(c["createElementVNode"])("br")],-1)),R={class:"mb-3"},_={class:"form-label"};function z(e,t,a,o,z,J){const G=Object(c["resolveComponent"])("HeaderMain"),L=Object(c["resolveComponent"])("Datepicker"),X=Object(c["resolveComponent"])("Footer");return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",n,[Object(c["createElementVNode"])("header",s,[Object(c["createVNode"])(G)]),Object(c["createElementVNode"])("section",r,[Object(c["createElementVNode"])("div",l,[Object(c["createElementVNode"])("div",d,[Object(c["createElementVNode"])("div",i,[m,Object(c["createElementVNode"])("div",b,[Object(c["createElementVNode"])("form",f,[Object(c["createElementVNode"])("div",h,[p,Object(c["createElementVNode"])("div",u,[j,Object(c["createElementVNode"])("div",O,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{type:"price",class:"form-control form-control-s1","onUpdate:modelValue":t[0]||(t[0]=e=>z.marketData.price=e),placeholder:"Amount"},null,512),[[c["vModelText"],z.marketData.price]])])])]),Object(c["createElementVNode"])("div",N,[Object(c["createElementVNode"])("div",g,[k,Object(c["createVNode"])(L,{modelValue:o.date,"onUpdate:modelValue":t[1]||(t[1]=e=>o.date=e),placeholder:"시작과 종료날짜를 모두 입력해주세요",range:""},null,8,["modelValue"])])]),Object(c["createElementVNode"])("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#saleCreateNftModal",onClick:t[2]||(t[2]=(...e)=>J.checkInputData&&J.checkInputData(...e)),class:"btn btn-dark d-block"},"Complete listing")])])])]),Object(c["createElementVNode"])("div",v,[Object(c["createElementVNode"])("div",V,[Object(c["createElementVNode"])("div",D,[Object(c["createElementVNode"])("img",{src:"https://j6e205.p.ssafy.io/"+o.marketInfoData.nft.fileUrl,class:"card-img-top",style:{height:"auto"},alt:"art image"},null,8,E)]),Object(c["createElementVNode"])("div",w,[Object(c["createElementVNode"])("h3",T,Object(c["toDisplayString"])(o.marketInfoData.nft.nftName),1),Object(c["createElementVNode"])("div",y,[S,Object(c["createElementVNode"])("div",I,[Object(c["createElementVNode"])("a",{class:"h4",href:"/profile/"+o.marketInfoData.nft.nftAuthorName},Object(c["toDisplayString"])(o.marketInfoData.nft.nftAuthorName),9,C)])]),Object(c["createElementVNode"])("div",x,[A,Object(c["createElementVNode"])("div",P,[F,Object(c["createElementVNode"])("h4",M,"₿ SSF "+Object(c["toDisplayString"])(this.marketData.price),1)])])])])])])]),Object(c["createVNode"])(X,{classname:"bg-black on-dark"}),this.date&&this.marketData.price?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",B,[Object(c["createElementVNode"])("div",K,[Object(c["createElementVNode"])("div",q,[U,Object(c["createElementVNode"])("div",$,[H,Object(c["createElementVNode"])("div",R,[Object(c["createElementVNode"])("label",_,Object(c["toDisplayString"])(z.SectionData.createNftModal.labelText),1),Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{type:"text",class:"form-control form-control-s1","onUpdate:modelValue":t[3]||(t[3]=e=>z.authorPrivateKey=e),placeholder:"please typing your Private Key"},null,512),[[c["vModelText"],z.authorPrivateKey]])]),Object(c["createElementVNode"])("button",{class:"btn btn-dark d-block",onClick:t[4]||(t[4]=(...e)=>J.submitSaleCreateNFT&&J.submitSaleCreateNFT(...e)),"data-bs-target":"#saleCreateNftModal2","data-bs-toggle":"modal"},"Confirm")])])])])):Object(c["createCommentVNode"])("",!0)])}var J=a("6c02"),G=a("bc3a"),L=a.n(G),X=a("99e5"),Y=a.n(X),Q=a("07a4"),W=a("fe42"),Z=a("acb3"),ee=a("c5fa"),te=a("574c"),ae=a("584d"),ce=a("5502");const oe="https://j6e205.p.ssafy.io",ne="http://20.196.209.2:8545";Z.abi;let se="0x6c927304104cdaa5a8b3691e0ade8a3ded41a333",re=ee.abi,le=ee.networks["202112031219"].address,de=te.abi,ie=te.networks["202112031219"].address,me=(ae.abi,new Y.a(new Y.a.providers.HttpProvider(ne)));var be={name:"SaleCreate",setup(){const e=Object(ce["e"])(),t=Object(c["computed"])(()=>e.state.authToken),a=Object(c["ref"])(""),o=Object(J["c"])(),n=o.params.id;L()({method:"get",url:`${oe}/api/nft/detail/${n}`,headers:{Authorization:t}}).then(e=>{console.log(e.data),a.value=e.data}).catch(()=>{alert("There is no item in our Market.")});const s=Object(c["ref"])();return Object(c["onMounted"])(()=>{const e=new Date;new Date((new Date).setDate(e.getDate()+7));let t=new Date(+e+324e5).toISOString().replace("T"," ").replace(/\..*/,""),a=new Date(new Date(+e).setDate(e.getDate()+7)+324e5).toISOString().replace("T"," ").replace(/\..*/,"");s.value=[t,a]}),{store:e,marketInfoData:a,date:s}},data(){return{thisItemData:[],id:"",SectionData:Q["a"],authorPrivateKey:null,newtokenId:null,marketData:{nftSeq:"",marketContractAddress:null,price:"",startTime:"",endTime:""},createSaleCA:null}},methods:{checkInputData(){this.date.length<2||!this.marketData.price?(alert("Please Input information for sales registration"),this.date=Object(c["ref"])(),this.marketData.price=null):console.log("성공")},async submitSaleCreateNFT(){console.log(this.marketInfoData.nft.nftTokenId,"this.marketInfoData.nft.nftTokenI");const e=await Object(W["a"])(this.authorPrivateKey),t=this.myAddress;if(e===t&&this.marketInfoData.nft.nftOwnerAddress==t){const e=await new me.eth.Contract(de,ie),a=this.date[0],c=this.date[1];console.log(a,"2"),console.log(c,"2"),console.log(Date.parse(a),Date.parse(c),"@");const o=await e.methods.createSale(this.marketInfoData.nft.nftTokenId,Number(this.marketData.price),Date.parse(a),Date.parse(c),se,le);console.log(o,"saleFactoryContractResult");const n=await o.encodeABI(),s=await o.estimateGas({from:t}),r={from:t,to:ie,gas:s,data:n};console.log(r,"saleCreateRawTx");const l=await me.eth.accounts.privateKeyToAccount(this.authorPrivateKey),d=await l.signTransaction(r);if(console.log(d,"signedTx"),null==d)alert("TransactionSignFailedException");else{await me.eth.sendSignedTransaction(d.rawTransaction);const o=await e.methods.allSales().call();console.log(o,"saleItems");const n=await e.getPastEvents("NewSale",{filter:{_owner:t}});console.log(n,"findMySales");const s=n[n.length-1].returnValues[0];n[n.length-1].returnValues[1],n[n.length-1].returnValues[2];let r=await new me.eth.Contract(re,le);const i=await r.methods.approve(s,this.marketInfoData.nft.nftTokenId),m=await i.encodeABI();console.log(m,"NFTContractInstanceEncodeMethod");const b={from:t,to:le,gas:5e7,data:m};console.log(b,"saleCreateRawTx");const f=await l.signTransaction(b);if(console.log(f,"NFTsignedTX"),null==f)alert("The sign of Approbation for NFT is not completed");else{const e=await me.eth.sendSignedTransaction(f.rawTransaction);console.log(e);let t=r.methods.getApproved(this.marketInfoData.nft.nftTokenId).call();console.log(t,"4"),this.marketData.nftSeq=this.marketInfoData.nft.nftSeq,this.marketData.marketContractAddress=s,this.marketData.startTime=a,this.marketData.endTime=c,L()({method:"post",url:oe+"/api/market/register/",headers:{Authorization:this.authToken},data:{nftSeq:this.marketInfoData.nft.nftSeq,marketContractAddress:s,price:Number(this.marketData.price),startTime:a,endTime:c}}).then(e=>{console.log(e,"백엔드에 저~장"),this.$router.push({name:"ProductDetail",params:{id:this.marketInfoData.nft.nftSeq}})}).catch(()=>{alert("There is no item in our Market.")})}}}else alert("Are you owner of this item? If you are, Please, check your Private key"),this.authorPrivateKey=null,this.$router.go()}},computed:{...Object(ce["d"])(["myAddress"]),...Object(ce["d"])(["authToken"])},mounted(){}},fe=(a("9521"),a("6b0d")),he=a.n(fe);const pe=he()(be,[["render",z],["__scopeId","data-v-1fd4f97f"]]);t["default"]=pe},d34c:function(e,t,a){}}]);